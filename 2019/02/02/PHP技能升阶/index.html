<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">

    

    
    <title>PHP技能升阶 | 陈义的个人博客</title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
        <meta name="keywords" content="PHP">
    
    <meta name="description" content="Date() 函数PHP Date() 函数把时间戳格式化为更易读的日期和时间。语法1date(format,timestamp) 参数描述  format    必需。规定时间戳的格式。 timestamp    可选。规定时间戳。默认是当前时间和日期。注释：时间戳是一种字符序列，它表示具体事件发生的日期和事件。  获得简单的日期date() 函数的格式参数是必需的，它们规定如何格式化日期或时">
<meta name="keywords" content="PHP">
<meta property="og:type" content="article">
<meta property="og:title" content="PHP技能升阶">
<meta property="og:url" content="http://yoursite.com/2019/02/02/PHP技能升阶/index.html">
<meta property="og:site_name" content="陈义的个人博客">
<meta property="og:description" content="Date() 函数PHP Date() 函数把时间戳格式化为更易读的日期和时间。语法1date(format,timestamp) 参数描述  format    必需。规定时间戳的格式。 timestamp    可选。规定时间戳。默认是当前时间和日期。注释：时间戳是一种字符序列，它表示具体事件发生的日期和事件。  获得简单的日期date() 函数的格式参数是必需的，它们规定如何格式化日期或时">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://yoursite.com/2019/02/02/PHP技能升阶/7fi6oy5ysf.jpeg">
<meta property="og:updated_time" content="2019-02-02T10:40:49.070Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="PHP技能升阶">
<meta name="twitter:description" content="Date() 函数PHP Date() 函数把时间戳格式化为更易读的日期和时间。语法1date(format,timestamp) 参数描述  format    必需。规定时间戳的格式。 timestamp    可选。规定时间戳。默认是当前时间和日期。注释：时间戳是一种字符序列，它表示具体事件发生的日期和事件。  获得简单的日期date() 函数的格式参数是必需的，它们规定如何格式化日期或时">
<meta name="twitter:image" content="http://yoursite.com/2019/02/02/PHP技能升阶/7fi6oy5ysf.jpeg">
    

    
        <link rel="alternate" href="/" title="陈义的个人博客" type="application/atom+xml">
    

    

    <link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/libs/titillium-web/styles.css">
    <link rel="stylesheet" href="/libs/source-code-pro/styles.css">

    <link rel="stylesheet" href="/css/style.css">

    <script src="/libs/jquery/3.3.1/jquery.min.js"></script>
    
    
        <link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">
    
    
        <link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css">
    
    
    


</head>
</html>
<body>
    <div id="wrap">
        <header id="header">
    <div id="header-outer" class="outer">
        <div class="container">
            <div class="container-inner">
                <div id="header-title">
                    <h1 class="logo-wrap">
                        <a href="/" class="logo"></a>
                    </h1>
                    
                        <h2 class="subtitle-wrap">
                            <p class="subtitle">学而不思则罔，思而不学则殆</p>
                        </h2>
                    
                </div>
                <div id="header-inner" class="nav-container">
                    <a id="main-nav-toggle" class="nav-icon fa fa-bars"></a>
                    <div class="nav-container-inner">
                        <ul id="main-nav">
                            
                                <li class="main-nav-list-item">
                                    <a class="main-nav-list-link" href="/">主页</a>
                                </li>
                            
                                        <ul class="main-nav-list"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/遥感/">遥感</a></li></ul>
                                    
                                <li class="main-nav-list-item">
                                    <a class="main-nav-list-link" href="/about/index.html">关于</a>
                                </li>
                            
                        </ul>
                        <nav id="sub-nav">
                            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="搜索">
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="想要查找什么...">
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>
        <div class="container">
            <div class="main-body container-inner">
                <div class="main-body-inner">
                    <section id="main">
                        <div class="main-body-header">
    <h1 class="header">
    
    未分类
    </h1>
</div>

                        <div class="main-body-content">
                            <article id="post-PHP技能升阶" class="article article-single article-type-post" itemscope="" itemprop="blogPost">
    <div class="article-inner">
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
        PHP技能升阶
        </h1>
    

            </header>
        
        
            <div class="article-meta">
                
    <div class="article-date">
        <a href="/2019/02/02/PHP技能升阶/" class="article-date">
            <time datetime="2019-02-02T01:24:14.000Z" itemprop="datePublished">2019-02-02</time>
        </a>
    </div>

		

                
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/PHP/">PHP</a>
    </div>

            </div>
        
        
        <div class="article-entry" itemprop="articleBody">
            <p><img src="/2019/02/02/PHP技能升阶/7fi6oy5ysf.jpeg" alt=""></p>
<h2 id="Date-函数"><a href="#Date-函数" class="headerlink" title="Date() 函数"></a>Date() 函数</h2><p>PHP Date() 函数把时间戳格式化为更易读的日期和时间。<br>语法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">date(format,timestamp)</span><br></pre></td></tr></table></figure></p>
<p>参数描述</p>
<ul>
<li>format    必需。规定时间戳的格式。</li>
<li>timestamp    可选。规定时间戳。默认是当前时间和日期。<br>注释：时间戳是一种字符序列，它表示具体事件发生的日期和事件。</li>
</ul>
<p><strong>获得简单的日期</strong><br>date() 函数的格式参数是必需的，它们规定如何格式化日期或时间。</p>
<ul>
<li>下面列出了一些常用于日期的字符：<ul>
<li>d - 表示月里的某天（01-31）</li>
<li>m - 表示月（01-12）</li>
<li>Y - 表示年（四位数）</li>
<li>1 - 表示周里的某天,完整的文本格式,（”L”的小写字母）<br>其他字符，比如 “/“, “.” 或 “-“ 也可被插入字符中，以增加其他格式。<br>下面的例子用三种不同方法格式今天的日期：<br>实例<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">echo &quot;今天是 &quot; . date(&quot;Y/m/d&quot;) . &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &quot;今天是 &quot; . date(&quot;Y.m.d&quot;) . &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &quot;今天是 &quot; . date(&quot;Y-m-d&quot;) . &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &quot;今天是 &quot; . date(&quot;l&quot;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<p>小实例：<br>PHP 提示 - 自动版权年份<br>使用 date() 函数在您的网站上自动更新版本年份：</p>
<p>实例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">版权所有 2008-&lt;?php echo date(&quot;Y&quot;)?&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<p>获得简单的时间</p>
<ul>
<li>下面是常用于时间的字符：<ul>
<li>h - 带有首位零的 12 小时小时格式</li>
<li>i - 带有首位零的分钟</li>
<li>s - 带有首位零的秒（00 -59）</li>
<li>a - 小写的午前和午后（am 或 pm）<br>下面的例子以指定的格式输出当前时间：</li>
</ul>
</li>
</ul>
<p>实例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">echo &quot;现在时间是 &quot; . date(&quot;h:i:sa&quot;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p><strong>注释：</strong>请注意 PHP date() 函数会返回服务器的当前日期/时间！</p>
<ul>
<li>获得时区<br>如果从代码返回的不是正确的时间，有可能是因为您的服务器位于其他国家或者被设置为不同时区。<br>因此，如果您需要基于具体位置的准确时间，您可以设置要用的时区。<br>下面的例子把时区设置为 “Asia/Shanghai”，然后以指定格式输出当前时间：</li>
</ul>
<p>实例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">date_default_timezone_set(&quot;Asia/Shanghai&quot;);</span><br><span class="line">echo &quot;当前时间是 &quot; . date(&quot;h:i:sa&quot;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p><strong>通过 PHP mktime() 创建日期</strong><br>date() 函数中可选的时间戳参数规定时间戳。如果您未规定时间戳，将使用当前日期和时间（正如上例中那样）。<br>mktime() 函数返回日期的 Unix 时间戳。Unix 时间戳包含 Unix 纪元（1970 年 1 月 1 日 00:00:00 GMT）与指定时间之间的秒数。<br>语法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mktime(hour,minute,second,month,day,year)</span><br></pre></td></tr></table></figure></p>
<p>下面的例子使用 mktime() 函数中的一系列参数来创建日期和时间：<br>实例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$d=mktime(9, 12, 31, 6, 10, 2015);</span><br><span class="line">echo &quot;创建日期是 &quot; . date(&quot;Y-m-d h:i:sa&quot;, $d);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p><strong>通过 PHP strtotime() 用字符串来创建日期</strong><br>PHP strtotime() 函数用于把人类可读的字符串转换为 Unix 时间。<br>语法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strtotime(time,now)</span><br></pre></td></tr></table></figure></p>
<p>下面的例子通过 strtotime() 函数创建日期和时间：<br>实例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$d=strtotime(&quot;10:38pm April 15 2015&quot;);</span><br><span class="line">echo &quot;创建日期是 &quot; . date(&quot;Y-m-d h:i:sa&quot;, $d);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>PHP 在将字符串转换为日期这方面非常聪明，所以您能够使用各种值：</p>
<p>实例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$d=strtotime(&quot;tomorrow&quot;);</span><br><span class="line">echo date(&quot;Y-m-d h:i:sa&quot;, $d) . &quot;&lt;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line">$d=strtotime(&quot;next Saturday&quot;);</span><br><span class="line">echo date(&quot;Y-m-d h:i:sa&quot;, $d) . &quot;&lt;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line">$d=strtotime(&quot;+3 Months&quot;);</span><br><span class="line">echo date(&quot;Y-m-d h:i:sa&quot;, $d) . &quot;&lt;br&gt;&quot;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>不过，strtotime() 并不完美，所以请记得检查放入其中的字符串。</p>
<p><strong>更多日期实例</strong><br>下例输出下周六的日期：<br>实例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$startdate = strtotime(&quot;Saturday&quot;);</span><br><span class="line">$enddate = strtotime(&quot;+6 weeks&quot;,$startdate);</span><br><span class="line"></span><br><span class="line">while ($startdate &lt; $enddate) &#123;</span><br><span class="line">  echo date(&quot;M d&quot;, $startdate),&quot;&lt;br&gt;&quot;;</span><br><span class="line">  $startdate = strtotime(&quot;+1 week&quot;, $startdate);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>下例输出七月四日之前的天数：<br>实例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$d1=strtotime(&quot;December 31&quot;);</span><br><span class="line">$d2=ceil(($d1-time())/60/60/24);</span><br><span class="line">echo &quot;距离十二月三十一日还有：&quot; . $d2 .&quot; 天。&quot;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="PHP-包含文件"><a href="#PHP-包含文件" class="headerlink" title="PHP 包含文件"></a>PHP 包含文件</h2><p><strong>服务器端包含 (SSI) 用于创建可在多个页面重复使用的函数、页眉、页脚或元素。</strong><br>include （或 require）语句会获取指定文件中存在的所有文本/代码/标记，并复制到使用 include 语句的文件中。<br>包含文件很有用，如果您需要在网站的多张页面上引用相同的 PHP、HTML 或文本的话。</p>
<p><strong>PHP include 和 require 语句</strong><br>通过 include 或 require 语句，可以将 PHP 文件的内容插入另一个 PHP 文件（在服务器执行它之前）。<br>include 和 require 语句用于在执行流中插入写在其他文件中的有用的代码。<br><code>include 和 require 语句是相同的，除了错误处理方面：</code></p>
<ul>
<li>require 会生成致命错误（E_COMPILE_ERROR）并停止脚本</li>
<li>include 只生成警告（E_WARNING），并且脚本会继续<br>因此，如果您希望继续执行，并向用户输出结果，即使包含文件已丢失，那么请使用 include。否则，在框架、CMS 或者复杂的 PHP 应用程序编程中，请始终使用 require 向执行流引用关键文件。这有助于提高应用程序的安全性和完整性，在某个关键文件意外丢失的情况下。</li>
</ul>
<p>包含文件省去了大量的工作。这意味着您可以为所有页面创建标准页头、页脚或者菜单文件。然后，在页头需要更新时，您只需更新这个页头包含文件即可。</p>
<p>语法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">include &apos;filename&apos;;</span><br><span class="line">或</span><br><span class="line">require &apos;filename&apos;;</span><br></pre></td></tr></table></figure></p>
<p><strong>PHP include 实例</strong></p>
<p>例子 1<br>假设我们有一个名为 “footer.php” 的标准的页脚文件，就像这样：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">echo &quot;&lt;p&gt;Copyright © 2006-&quot; . date(&quot;Y&quot;) . &quot; W3School.com.cn&lt;/p&gt;&quot;;</span><br><span class="line">?&gt;</span><br><span class="line">``</span><br></pre></td></tr></table></figure></p>
<p>如需在一张页面中引用这个页脚文件，请使用 include 语句：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;h1&gt;欢迎访问我们的首页！&lt;/h1&gt;</span><br><span class="line">&lt;p&gt;一段文本。&lt;/p&gt;</span><br><span class="line">&lt;p&gt;一段文本。&lt;/p&gt;</span><br><span class="line">&lt;?php include &apos;footer.php&apos;;?&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<p>例子 2</p>
<p>假设我们有一个名为 “vars.php” 的文件，其中定义了一些变量：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$color=&apos;银色的&apos;;</span><br><span class="line">$car=&apos;奔驰轿车&apos;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>然后，如果我们引用这个 “vars.php” 文件，就可以在调用文件中使用这些变量：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;h1&gt;欢迎访问我的首页！&lt;/h1&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">include &apos;vars.php&apos;;</span><br><span class="line">echo &quot;我有一辆&quot; . $color . $car &quot;。&quot;;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<p><strong>PHP include vs. require</strong><br>require 语句同样用于向 PHP 代码中引用文件。<br>不过，include 与 require 有一个巨大的差异：如果用 include 语句引用某个文件并且 PHP 无法找到它，脚本会继续执行：<br>实例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;h1&gt;Welcome to my home page!&lt;/h1&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">include &apos;noFileExists.php&apos;;</span><br><span class="line">echo &quot;I have a $color $car.&quot;;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<p>如果我们使用 require 语句完成相同的案例，echo 语句不会继续执行，因为在 require 语句返回严重错误之后脚本就会终止执行：<br>实例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;h1&gt;Welcome to my home page!&lt;/h1&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">require &apos;noFileExists.php&apos;;</span><br><span class="line">echo &quot;I have a $color $car.&quot;;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<p><strong>注释：</strong><br>请在此时使用 require：当文件被应用程序请求时。<br>请在此时使用 include：当文件不是必需的，且应用程序在文件未找到时应该继续运行时。</p>
<p><strong>include 和 require 的区别</strong></p>
<ul>
<li>require 一般放在 PHP 文件的最前面，程序在执行前就会先导入要引用的文件；</li>
<li>include 一般放在程序的流程控制中，当程序执行时碰到才会引用，简化程序的执行流程。</li>
<li>require 引入的文件有错误时，执行会中断，并返回一个致命错误；</li>
<li>include 引入的文件有错误时，会继续执行，并返回一个警告。</li>
</ul>
<h2 id="PHP-操作文件"><a href="#PHP-操作文件" class="headerlink" title="PHP 操作文件"></a>PHP 操作文件</h2><p>PHP 拥有的多种函数可供创建、读取、上传以及编辑文件。<br><strong>注意：</strong>请谨慎操作文件！<br>当您操作文件时必须非常小心。如果您操作失误，可能会造成非常严重的破坏。常见的错误是：</p>
<ul>
<li>编辑错误的文件</li>
<li>被垃圾数据填满硬盘</li>
<li>意外删除文件内容<br><strong>PHP readfile() 函数</strong><br>readfile() 函数读取文件，并把它写入输出缓冲。</li>
</ul>
<p>假设我们有一个名为 “webdictionary.txt” 的文本文件，存放在服务器上，就像这样：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">AJAX = Asynchronous JavaScript and XML</span><br><span class="line">CSS = Cascading Style Sheets</span><br><span class="line">HTML = Hyper Text Markup Language</span><br><span class="line">PHP = PHP Hypertext Preprocessor</span><br><span class="line">SQL = Structured Query Language</span><br><span class="line">SVG = Scalable Vector Graphics</span><br><span class="line">XML = EXtensible Markup Language</span><br></pre></td></tr></table></figure></p>
<p>读取此文件并写到输出流的 PHP 代码如下（如读取成功则 readfile() 函数返回字节数）：<br>实例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">echo readfile(&quot;webdictionary.txt&quot;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>如果您想做的所有事情就是打开一个文件并读取器内容，那么 readfile() 函数很有用。<br><strong>PHP Open File - fopen()</strong></p>
<blockquote>
<p>打开文件的更好的方法是通过 fopen() 函数。此函数为您提供比 readfile() 函数更多的选项。</p>
</blockquote>
<p>fopen() 的第一个参数包含被打开的文件名，第二个参数规定打开文件的模式。如果 fopen() 函数未能打开指定的文件，下面的例子会生成一段消息：</p>
<p>实例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$myfile = fopen(&quot;webdictionary.txt&quot;, &quot;r&quot;) or die(&quot;Unable to open file!&quot;);</span><br><span class="line">echo fread($myfile,filesize(&quot;webdictionary.txt&quot;));</span><br><span class="line">fclose($myfile);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p><code>提示：</code>die()和exit()<br>die()和exit()函数都有终止线程的作用，是php断点调试需要使用的最主要的函数，它们也是php程序员使用非常频繁的函数。然而两者又有什么区别呢？在程序调试时需要注意什么问题呢？<br>die()函数一般与“or”一并使用，写作“or die()”，经常看到这样的语句：<br><code>$file = fopen($filename, &#39;r&#39;) or die(&quot;抱歉，无法打开: $filename&quot;)</code><br>or在这里是这样理解的，因为在PHP中并不区分数据类型，所以$file既可以是int也可以bool，所以这样的语句不会报错。但其处理过程可能有些朋友不大明白。其实在大多数的语言中， bool or bool这样的语句中，如果前一个值为真后一个值就不会再判断了。这里也是的，所以如果fopen函数执行正确的话，会返回一个大于0的int值（这其实就是”真”），后面的语句就不会执行了。如果fopen函数执行失败，就会返回false，那么就会判断后面的表达式是否为真了。结果执行了die()之后，不管返回什么，程序都已经停止执行了，并且显示指定的出错信息，也就达到了调试的目的。就这样。</p>
<p>实际上，die和exit是等价的，都是用来终止当前脚本。<br>php手册对两者的解释如是说：<br>exit() 函数输出一条消息，并退出当前脚本。该函数是 die() 函数的别名。<br>die() 函数输出一条消息，并退出当前脚本。该函数是 exit() 函数的别名。<br>die是遇到错误才停止<br>exit是直接停止，并且不运行后续代码，exit()可以显示内容。<br>return就是纯粹的返回值了，但是也不会运行后续代码<br>exit（0）：正常运行程序并退出程序；<br>exit（1）：非正常运行导致退出程序；<br>return（）：返回函数，若在主函数中，则会退出函数并返回一值。</p>
<p>文件会以如下模式之一打开：</p>
<table>
<thead>
<tr>
<th style="text-align:left">模式</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">r</td>
<td>打开文件为只读。文件指针在文件的开头开始。</td>
</tr>
<tr>
<td style="text-align:left">w</td>
<td>打开文件为只写。删除文件的内容或创建一个新的文件，如果它不存在。文件指针在文件的开头开始。</td>
</tr>
<tr>
<td style="text-align:left">a</td>
<td>打开文件为只写。文件中的现有数据会被保留。文件指针在文件结尾开始。创建新的文件，如果文件不存在。</td>
</tr>
<tr>
<td style="text-align:left">x</td>
<td>创建新文件为只写。返回 FALSE 和错误，如果文件已存在。</td>
</tr>
<tr>
<td style="text-align:left">r+</td>
<td>打开文件为读/写、文件指针在文件开头开始。</td>
</tr>
<tr>
<td style="text-align:left">w+</td>
<td>打开文件为读/写。删除文件内容或创建新文件，如果它不存在。文件指针在文件开头开始。</td>
</tr>
<tr>
<td style="text-align:left">a+</td>
<td>打开文件为读/写。文件中已有的数据会被保留。文件指针在文件结尾开始。创建新文件，如果它不存在。</td>
</tr>
<tr>
<td style="text-align:left">x+</td>
<td>创建新文件为读/写。返回 FALSE 和错误，如果文件已存在。</td>
</tr>
</tbody>
</table>
<p>如果打开一个文件，文件名为中文，如果系统编程和当前文档编码不一致，会导致文件找不到无法打开，解决方法是用 iconv 函数编码转换成一致，如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$fpath=iconv(&apos;UTF-8&apos;,&apos;GB2312&apos;,&quot;题库.csv&quot;);</span><br><span class="line">$file=fopen($fpath,&quot;r&quot;) or exit(&quot;无法打开文件!&quot;);</span><br><span class="line">//此处省略相关操作</span><br><span class="line">fclose($file);</span><br></pre></td></tr></table></figure></p>
<p>用相对路径打不开子目录中的文件时，可用绝对路径打开，如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$file=fopen(dirname(__FILE__).&apos;\\files\\tk.csv&apos;,&quot;r&quot;) or exit(&quot;无法打开文件!&quot;);   </span><br><span class="line">//此处省略相关操作</span><br><span class="line">fclose($file);</span><br></pre></td></tr></table></figure></p>
<p><strong>PHP 读取文件 - fread()</strong><br>fread() 函数读取打开的文件。<br>fread() 的第一个参数包含待读取文件的文件名，第二个参数规定待读取的最大字节数。<br>如下 PHP 代码把 “webdictionary.txt” 文件读至结尾：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fread($myfile,filesize(&quot;webdictionary.txt&quot;));</span><br></pre></td></tr></table></figure></p>
<p><strong>PHP 关闭文件 - fclose()</strong><br>fclose() 函数用于关闭打开的文件。<br><strong>注释：</strong>用完文件后把它们全部关闭是一个良好的编程习惯。您并不想打开的文件占用您的服务器资源。<br>fclose() 需要待关闭文件的名称（或者存有文件名的变量）：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$myfile = fopen(&quot;webdictionary.txt&quot;, &quot;r&quot;);</span><br><span class="line">// some code to be executed....</span><br><span class="line">fclose($myfile);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p><strong>PHP 读取单行文件 - fgets()</strong><br>fgets() 函数用于从文件读取单行。<br>下例输出 “webdictionary.txt” 文件的首行：<br>实例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$myfile = fopen(&quot;webdictionary.txt&quot;, &quot;r&quot;) or die(&quot;Unable to open file!&quot;);</span><br><span class="line">echo fgets($myfile);</span><br><span class="line">fclose($myfile);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p><strong>注释：</strong>调用 fgets() 函数之后，文件指针会移动到下一行。</p>
<p><strong>PHP 检查 End-Of-File - feof()</strong><br>feof() 函数检查是否已到达 “end-of-file” (EOF)。<br>feof() 对于遍历未知长度的数据很有用。<br>下例逐行读取 “webdictionary.txt” 文件，直到 end-of-file：<br>实例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$myfile = fopen(&quot;webdictionary.txt&quot;, &quot;r&quot;) or die(&quot;Unable to open file!&quot;);</span><br><span class="line">// 输出单行直到 end-of-file</span><br><span class="line">while(!feof($myfile)) &#123;</span><br><span class="line">  echo fgets($myfile) . &quot;&lt;br&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">fclose($myfile);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p><strong>PHP 读取单字符 - fgetc()</strong><br>fgetc() 函数用于从文件中读取单个字符。<br>下例逐字符读取 “webdictionary.txt” 文件，直到 end-of-file：<br>实例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$myfile = fopen(&quot;webdictionary.txt&quot;, &quot;r&quot;) or die(&quot;Unable to open file!&quot;);</span><br><span class="line">// 输出单字符直到 end-of-file</span><br><span class="line">while(!feof($myfile)) &#123;</span><br><span class="line">  echo fgetc($myfile);</span><br><span class="line">&#125;</span><br><span class="line">fclose($myfile);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p><strong>注释：</strong>在调用 fgetc() 函数之后，文件指针会移动到下一个字符。</p>
<p><strong>PHP 创建文件 - fopen()</strong><br>fopen() 函数也用于创建文件。也许有点混乱，但是在 PHP 中，创建文件所用的函数与打开文件的相同。<br>如果您用 fopen() 打开并不存在的文件，此函数会创建文件，假定文件被打开为写入（w）或增加（a）。<br>下面的例子创建名为 “testfile.txt” 的新文件。此文件将被创建于 PHP 代码所在的相同目录中：<br>实例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$myfile = fopen(&quot;testfile.txt&quot;, &quot;w&quot;)</span><br></pre></td></tr></table></figure></p>
<p><strong>PHP 文件权限</strong><br>如果您试图运行这段代码时发生错误，请检查您是否有向硬盘写入信息的 PHP 文件访问权限。</p>
<p><strong>PHP 写入文件 - fwrite()</strong><br>fwrite() 函数用于写入文件。<br>fwrite() 的第一个参数包含要写入的文件的文件名，第二个参数是被写的字符串。<br>下面的例子把姓名写入名为 “newfile.txt” 的新文件中：<br>实例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$myfile = fopen(&quot;newfile.txt&quot;, &quot;w&quot;) or die(&quot;Unable to open file!&quot;);</span><br><span class="line">$txt = &quot;Bill Gates\n&quot;;</span><br><span class="line">fwrite($myfile, $txt);</span><br><span class="line">$txt = &quot;Steve Jobs\n&quot;;</span><br><span class="line">fwrite($myfile, $txt);</span><br><span class="line">fclose($myfile);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>请注意，我们向文件 “newfile.txt” 写了两次。在每次我们向文件写入时，在我们发送的字符串 $txt 中，第一次包含 “Bill Gates”，第二次包含 “Steve Jobs”。在写入完成后，我们使用 fclose() 函数来关闭文件。</p>
<p>如果我们打开 “newfile.txt” 文件，它应该是这样的：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Bill Gates</span><br><span class="line">Steve Jobs</span><br></pre></td></tr></table></figure></p>
<p><strong>PHP 覆盖（Overwriting）</strong><br>如果现在 “newfile.txt” 包含了一些数据，我们可以展示在写入已有文件时发生的的事情。所有已存在的数据会被擦除并以一个新文件开始。<br>在下面的例子中，我们打开一个已存在的文件 “newfile.txt”，并向其中写入了一些新数据：<br>实例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$myfile = fopen(&quot;newfile.txt&quot;, &quot;w&quot;) or die(&quot;Unable to open file!&quot;);</span><br><span class="line">$txt = &quot;Mickey Mouse\n&quot;;</span><br><span class="line">fwrite($myfile, $txt);</span><br><span class="line">$txt = &quot;Minnie Mouse\n&quot;;</span><br><span class="line">fwrite($myfile, $txt);</span><br><span class="line">fclose($myfile);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>如果现在我们打开这个 “newfile.txt” 文件，Bill 和 Steve 都已消失，只剩下我们刚写入的数据：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Mickey Mouse</span><br><span class="line">Minnie Mouse</span><br></pre></td></tr></table></figure></p>
<h2 id="PHP-文件上传"><a href="#PHP-文件上传" class="headerlink" title="PHP 文件上传"></a>PHP 文件上传</h2><p><strong>通过 PHP，可以把文件上传到服务器。</strong><br>本环节实例在 test 项目下完成，目录结构为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">test</span><br><span class="line">|-----upload             # 文件上传的目录</span><br><span class="line">|-----form.html          # 表单文件</span><br><span class="line">|-----upload_file.php    # php 上传代码</span><br></pre></td></tr></table></figure></p>
<p><strong>创建一个文件上传表单</strong><br>允许用户从表单上传文件是非常有用的。<br>请看下面这个供上传文件的 HTML 表单：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;form action=&quot;upload_file.php&quot; method=&quot;post&quot;</span><br><span class="line">enctype=&quot;multipart/form-data&quot;&gt;</span><br><span class="line">&lt;label for=&quot;file&quot;&gt;文件名:&lt;/label&gt;</span><br><span class="line">&lt;input type=&quot;file&quot; name=&quot;file&quot; id=&quot;file&quot; /&gt; </span><br><span class="line">&lt;br /&gt;</span><br><span class="line">&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Submit&quot; /&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<p>将以上代码保存到 form.html 文件中。<br>请留意如下有关此表单的信息：<br><code>&lt;form&gt;</code>标签的<strong>enctype</strong>属性规定了在提交表单时要使用哪种内容类型。在表单需要二进制数据时，比如文件内容，请使用 “multipart/form-data”。<br><code>&lt;input&gt;</code>标签的<strong>type=”file”</strong>属性规定了应该把输入作为文件来处理。举例来说，当在浏览器中预览时，会看到输入框旁边有一个浏览按钮。<br><strong>注释：</strong>允许用户上传文件是一个巨大的安全风险。请仅仅允许可信的用户执行文件上传操作。</p>
<p><strong>创建上传脚本</strong><br>“upload_file.php” 文件含有供上传文件的代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if ($_FILES[&quot;file&quot;][&quot;error&quot;] &gt; 0)</span><br><span class="line">  &#123;</span><br><span class="line">  echo &quot;Error: &quot; . $_FILES[&quot;file&quot;][&quot;error&quot;] . &quot;&lt;br /&gt;&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">else</span><br><span class="line">  &#123;</span><br><span class="line">  echo &quot;上传文件名: &quot; . $_FILES[&quot;file&quot;][&quot;name&quot;] . &quot;&lt;br /&gt;&quot;;</span><br><span class="line">  echo &quot;文件类型: &quot; . $_FILES[&quot;file&quot;][&quot;type&quot;] . &quot;&lt;br /&gt;&quot;;</span><br><span class="line">  echo &quot;文件大小: &quot; . ($_FILES[&quot;file&quot;][&quot;size&quot;] / 1024) . &quot; Kb&lt;br /&gt;&quot;;</span><br><span class="line">  echo &quot;文件临时存储的位置Stored in: &quot; . $_FILES[&quot;file&quot;][&quot;tmp_name&quot;];</span><br><span class="line">  &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>通过使用 PHP 的全局数组 $_FILES，你可以从客户计算机向远程服务器上传文件。<br>第一个参数是表单的 input name，第二个下标可以是 “name”, “type”, “size”, “tmp_name” 或 “error”。就像这样：</p>
<ul>
<li>$_FILES[“file”][“name”] - 被上传文件的名称</li>
<li>$_FILES[“file”][“type”] - 被上传文件的类型</li>
<li>$_FILES[“file”][“size”] - 被上传文件的大小，以字节计</li>
<li>$_FILES[“file”][“tmp_name”] - 存储在服务器的文件的临时副本的名称</li>
<li>$_FILES[“file”][“error”] - 由文件上传导致的错误代码</li>
</ul>
<p>这是一种非常简单文件上传方式。基于安全方面的考虑，您应当增加有关什么用户有权上传文件的限制。</p>
<p><strong>上传限制</strong><br>在这个脚本中，我们增加了对文件上传的限制。用户只能上传 .gif 或 .jpeg 文件，文件大小必须小于 20 kb：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">// 允许上传的图片后缀</span><br><span class="line">$allowedExts = array(&quot;gif&quot;, &quot;jpeg&quot;, &quot;jpg&quot;, &quot;png&quot;);</span><br><span class="line">$temp = explode(&quot;.&quot;, $_FILES[&quot;file&quot;][&quot;name&quot;]);</span><br><span class="line">$extension = end($temp);        // 获取文件后缀名</span><br><span class="line">if ((($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/gif&quot;)</span><br><span class="line">|| ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/jpeg&quot;)</span><br><span class="line">|| ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/pjpeg&quot;))</span><br><span class="line">&amp;&amp; ($_FILES[&quot;file&quot;][&quot;size&quot;] &lt; 204800)    // 小于 200 kb</span><br><span class="line">  &#123;</span><br><span class="line">  if ($_FILES[&quot;file&quot;][&quot;error&quot;] &gt; 0)</span><br><span class="line">    &#123;</span><br><span class="line">    echo &quot;Error: &quot; . $_FILES[&quot;file&quot;][&quot;error&quot;] . &quot;&lt;br /&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">  else</span><br><span class="line">    &#123;</span><br><span class="line">    echo &quot;Upload: &quot; . $_FILES[&quot;file&quot;][&quot;name&quot;] . &quot;&lt;br /&gt;&quot;;</span><br><span class="line">    echo &quot;Type: &quot; . $_FILES[&quot;file&quot;][&quot;type&quot;] . &quot;&lt;br /&gt;&quot;;</span><br><span class="line">    echo &quot;Size: &quot; . ($_FILES[&quot;file&quot;][&quot;size&quot;] / 1024) . &quot; Kb&lt;br /&gt;&quot;;</span><br><span class="line">    echo &quot;Stored in: &quot; . $_FILES[&quot;file&quot;][&quot;tmp_name&quot;];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">else</span><br><span class="line">  &#123;</span><br><span class="line">  echo &quot;Invalid file&quot;;//非法的文件格式</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p><strong>注释：</strong>对于 IE，识别 jpg 文件的类型必须是 pjpeg，对于 FireFox，必须是 jpeg。</p>
<p><strong>保存被上传的文件</strong><br>上面的例子在服务器的 PHP 临时文件夹创建了一个被上传文件的临时副本。<br>这个临时的复制文件会在脚本结束时消失。要保存被上传的文件，我们需要把它拷贝到另外的位置：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">// 允许上传的图片后缀</span><br><span class="line">$allowedExts = array(&quot;gif&quot;, &quot;jpeg&quot;, &quot;jpg&quot;, &quot;png&quot;);</span><br><span class="line">$temp = explode(&quot;.&quot;, $_FILES[&quot;file&quot;][&quot;name&quot;]);</span><br><span class="line">echo $_FILES[&quot;file&quot;][&quot;size&quot;];</span><br><span class="line">$extension = end($temp);     // 获取文件后缀名</span><br><span class="line">if ((($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/gif&quot;)</span><br><span class="line">|| ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/jpeg&quot;)</span><br><span class="line">|| ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/pjpeg&quot;))</span><br><span class="line">&amp;&amp; ($_FILES[&quot;file&quot;][&quot;size&quot;] &lt;  204800)   // 小于 200 kb</span><br><span class="line">  &#123;</span><br><span class="line">  if ($_FILES[&quot;file&quot;][&quot;error&quot;] &gt; 0)</span><br><span class="line">    &#123;</span><br><span class="line">    echo &quot;Return Code: &quot; . $_FILES[&quot;file&quot;][&quot;error&quot;] . &quot;&lt;br /&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">  else</span><br><span class="line">    &#123;</span><br><span class="line">    echo &quot;Upload: &quot; . $_FILES[&quot;file&quot;][&quot;name&quot;] . &quot;&lt;br /&gt;&quot;;</span><br><span class="line">    echo &quot;Type: &quot; . $_FILES[&quot;file&quot;][&quot;type&quot;] . &quot;&lt;br /&gt;&quot;;</span><br><span class="line">    echo &quot;Size: &quot; . ($_FILES[&quot;file&quot;][&quot;size&quot;] / 1024) . &quot; Kb&lt;br /&gt;&quot;;</span><br><span class="line">    echo &quot;Temp file: &quot; . $_FILES[&quot;file&quot;][&quot;tmp_name&quot;] . &quot;&lt;br /&gt;&quot;;</span><br><span class="line">	// 判断当期目录下的 upload 目录是否存在该文件</span><br><span class="line">    // 如果没有 upload 目录，你需要创建它，upload 目录权限为 777</span><br><span class="line">    if (file_exists(&quot;upload/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;]))</span><br><span class="line">      &#123;</span><br><span class="line">      echo $_FILES[&quot;file&quot;][&quot;name&quot;] . &quot; already exists. &quot;;</span><br><span class="line">      &#125;</span><br><span class="line">    else</span><br><span class="line">      &#123;</span><br><span class="line">	  // 如果 upload 目录不存在该文件则将文件上传到 upload 目录下</span><br><span class="line">      move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;],</span><br><span class="line">      &quot;upload/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;]);</span><br><span class="line">      echo &quot;Stored in: &quot; . &quot;upload/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">else</span><br><span class="line">  &#123;</span><br><span class="line">  echo &quot;Invalid file&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>上面的脚本检测了是否已存在此文件，如果不存在，则把文件拷贝到指定的文件夹。<br><strong>注释：</strong>这个例子把文件保存到了名为 “upload” 的新文件夹。</p>
<h2 id="PHP-Cookies"><a href="#PHP-Cookies" class="headerlink" title="PHP Cookies"></a>PHP Cookies</h2><p><strong>cookie 常用于识别用户。</strong><br><strong>什么是 Cookie？</strong><br>cookie 常用于识别用户。cookie 是服务器留在用户计算机中的小文件。每当相同的计算机通过浏览器请求页面时，它同时会发送 cookie。通过 PHP，您能够创建并取回 cookie 的值。</p>
<p><strong>如何创建 cookie？</strong><br>setcookie() 函数用于设置 cookie。<br><strong>注释：</strong>setcookie() 函数必须位于 <html> 标签之前。<br>语法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setcookie(name, value, expire, path, domain);</span><br></pre></td></tr></table></figure></html></p>
<p>例子<br>在下面的例子中，我们将创建名为 “user” 的 cookie，把为它赋值 “Alex Porter”。我们也规定了此 cookie 在一小时后过期：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">setcookie(&quot;user&quot;, &quot;Alex Porter&quot;, time()+3600);</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">.....</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<p><strong>注释：</strong>在发送 cookie 时，cookie 的值会自动进行 URL 编码，在取回时进行自动解码（为防止 URL 编码，请使用 setrawcookie() 取而代之）。</p>
<p><strong>如何取回 Cookie 的值？</strong><br>PHP 的 $_COOKIE 变量用于取回 cookie 的值。<br>在下面的例子中，我们取回了名为 “user” 的 cookie 的值，并把它显示在了页面上：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">// 输出 cookie 值</span><br><span class="line">echo $_COOKIE[&quot;user&quot;];</span><br><span class="line"></span><br><span class="line">// 查看所有 cookie</span><br><span class="line">print_r($_COOKIE);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>在下面的例子中，我们使用 isset() 函数来确认是否已设置了 cookie：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">if (isset($_COOKIE[&quot;user&quot;]))</span><br><span class="line">  echo &quot;Welcome &quot; . $_COOKIE[&quot;user&quot;] . &quot;!&lt;br /&gt;&quot;;</span><br><span class="line">else</span><br><span class="line">  echo &quot;Welcome guest!&lt;br /&gt;&quot;;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<p><strong>如何删除 cookie？</strong><br>当删除 cookie 时，您应当使过期日期变更为过去的时间点。<br>删除的例子：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">// 设置 cookie 过期时间为过去 1 小时</span><br><span class="line">setcookie(&quot;user&quot;, &quot;&quot;, time()-3600);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p><strong>如果浏览器不支持 cookie 该怎么办？</strong><br>如果您的应用程序涉及不支持 cookie 的浏览器，您就不得不采取其他方法在应用程序中从一张页面向另一张页面传递信息。一种方式是从表单传递数据（有关表单和用户输入的内容，稍早前我们已经在本教程中介绍过了）。<br>下面的表单在用户单击提交按钮时向 “welcome.php” 提交了用户输入：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;form action=&quot;welcome.php&quot; method=&quot;post&quot;&gt;</span><br><span class="line">Name: &lt;input type=&quot;text&quot; name=&quot;name&quot; /&gt;</span><br><span class="line">Age: &lt;input type=&quot;text&quot; name=&quot;age&quot; /&gt;</span><br><span class="line">&lt;input type=&quot;submit&quot; /&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<p>取回 “welcome.php” 中的值，就像这样：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">Welcome &lt;?php echo $_POST[&quot;name&quot;]; ?&gt;.&lt;br /&gt;</span><br><span class="line">You are &lt;?php echo $_POST[&quot;age&quot;]; ?&gt; years old.</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="PHP-Sessions"><a href="#PHP-Sessions" class="headerlink" title="PHP Sessions"></a>PHP Sessions</h2><blockquote>
<p>PHP session 变量用于存储有关用户会话的信息，或更改用户会话的设置。Session 变量保存的信息是单一用户的，并且可供应用程序中的所有页面使用。</p>
</blockquote>
<p><strong>PHP Session 变量</strong><br>当您运行一个应用程序时，您会打开它，做些更改，然后关闭它。这很像一次会话。计算机清楚你是谁。它知道你何时启动应用程序，并在何时终止。但是在因特网上，存在一个问题：服务器不知道你是谁以及你做什么，这是由于 HTTP 地址不能维持状态。</p>
<p>通过在服务器上存储用户信息以便随后使用，PHP session 解决了这个问题（比如用户名称、购买商品等）。不过，会话信息是临时的，在用户离开网站后将被删除。如果您需要永久储存信息，可以把数据存储在数据库中。</p>
<p>Session 的工作机制是：为每个访问者创建一个唯一的 id (UID)，并基于这个 UID 来存储变量。UID 存储在 cookie 中，亦或通过 URL 进行传导。</p>
<p><strong>开始 PHP Session</strong><br>在您把用户信息存储到 PHP session 中之前，首先必须启动会话。</p>
<p><strong>注释：</strong>session_start() 函数必须位于 <html> 标签之前：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php session_start(); ?&gt;</span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">....</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></html></p>
<p>上面的代码会向服务器注册用户的会话，以便您可以开始保存用户信息，同时会为用户会话分配一个 UID。</p>
<p><strong>存储 Session 变量</strong><br>存储和取回 session 变量的正确方法是使用 PHP $_SESSION 变量：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">session_start();</span><br><span class="line">// 存储 session 数据</span><br><span class="line">$_SESSION[&apos;views&apos;]=1;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">// 检索 session 数据</span><br><span class="line">echo &quot;浏览量：&quot;. $_SESSION[&apos;views&apos;];</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<p>输出：<br>     浏览量：1</p>
<p>在下面的例子中，我们创建了一个简单的 page-view 计数器。isset() 函数检测是否已设置 “views” 变量。如果已设置 “views” 变量，我们累加计数器。如果 “views” 不存在，则我们创建 “views” 变量，并把它设置为 1：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if(isset($_SESSION[&apos;views&apos;]))</span><br><span class="line">&#123;</span><br><span class="line">    $_SESSION[&apos;views&apos;]=$_SESSION[&apos;views&apos;]+1;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">    $_SESSION[&apos;views&apos;]=1;</span><br><span class="line">&#125;</span><br><span class="line">echo &quot;浏览量：&quot;. $_SESSION[&apos;views&apos;];</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p><strong>终结 Session</strong><br>如果您希望删除某些 session 数据，可以使用 unset() 或 session_destroy() 函数。<br>unset() 函数用于释放指定的 session 变量：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">session_start();</span><br><span class="line">if(isset($_SESSION[&apos;views&apos;]))</span><br><span class="line">&#123;</span><br><span class="line">    unset($_SESSION[&apos;views&apos;]);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>您也可以通过 session_destroy() 函数彻底终结 session：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">session_destroy();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p><strong>注释：</strong>session_destroy() 将重置 session，您将失去所有已存储的 session 数据。</p>
<h2 id="PHP-发送电子邮件"><a href="#PHP-发送电子邮件" class="headerlink" title="PHP 发送电子邮件"></a>PHP 发送电子邮件</h2><p><strong>PHP 允许您从脚本直接发送电子邮件。</strong></p>
<p><strong>PHP mail() 函数</strong><br>PHP mail() 函数用于从脚本中发送电子邮件。</p>
<p>语法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mail(to,subject,message,headers,parameters)</span><br></pre></td></tr></table></figure></p>
<table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">to</td>
<td>必需。规定 email 接收者。</td>
</tr>
<tr>
<td style="text-align:left">subject</td>
<td>必需。规定 email 的主题。注释：该参数不能包含任何新行字符。</td>
</tr>
<tr>
<td style="text-align:left">message</td>
<td>必需。定义要发送的消息。应使用 LF (\n) 来分隔各行。</td>
</tr>
<tr>
<td style="text-align:left">headers</td>
</tr>
</tbody>
</table>
<p>可选。规定附加的标题，比如 From、Cc 以及 Bcc。</p>
<p>应当使用 CRLF (\r\n) 分隔附加的标题。|</p>
<p>|parameters|    可选。对邮件发送程序规定额外的参数。|</p>
<p><strong>注释：</strong>PHP 需要一个已安装且正在运行的邮件系统，以便使邮件函数可用。所用的程序通过在 php.ini 文件中的配置设置进行定义。</p>
<p><strong>PHP 简易 E-Mail</strong><br>通过 PHP 发送电子邮件的最简单的方式是发送一封文本 email。</p>
<p>在下面的例子中，我们首先声明变量($to, $subject, $message, $from, $headers)，然后我们在 mail() 函数中使用这些变量来发送了一封 e-mail：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$to = &quot;someone@example.com&quot;;         // 邮件接收者</span><br><span class="line">$subject = &quot;参数邮件&quot;;                // 邮件标题</span><br><span class="line">$message = &quot;Hello! 这是邮件的内容。&quot;;  // 邮件正文</span><br><span class="line">$from = &quot;someonelse@example.com&quot;;   // 邮件发送者</span><br><span class="line">$headers = &quot;From:&quot; . $from;         // 头部信息设置</span><br><span class="line">mail($to,$subject,$message,$headers);</span><br><span class="line">echo &quot;邮件已发送&quot;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p><strong>PHP Mail 表单</strong><br>通过 PHP，您能够在自己的站点制作一个反馈表单。下面的例子向指定的 e-mail 地址发送了一条文本消息：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">if (isset($_REQUEST[&apos;email&apos;])) &#123; // 如果接收到邮箱参数则发送邮件</span><br><span class="line">    // 发送邮件</span><br><span class="line">    $email = $_REQUEST[&apos;email&apos;] ;</span><br><span class="line">    $subject = $_REQUEST[&apos;subject&apos;] ;</span><br><span class="line">    $message = $_REQUEST[&apos;message&apos;] ;</span><br><span class="line">    mail(&quot;someone@example.com&quot;, $subject,</span><br><span class="line">    $message, &quot;From:&quot; . $email);</span><br><span class="line">    echo &quot;邮件发送成功&quot;;</span><br><span class="line">&#125; else &#123; // 如果没有邮箱参数则显示表单</span><br><span class="line">    echo &quot;&lt;form method=&apos;post&apos; action=&apos;mailform.php&apos;&gt;</span><br><span class="line">    Email: &lt;input name=&apos;email&apos; type=&apos;text&apos;&gt;&lt;br&gt;</span><br><span class="line">    Subject: &lt;input name=&apos;subject&apos; type=&apos;text&apos;&gt;&lt;br&gt;</span><br><span class="line">    Message:&lt;br&gt;</span><br><span class="line">    &lt;textarea name=&apos;message&apos; rows=&apos;15&apos; cols=&apos;40&apos;&gt;</span><br><span class="line">    &lt;/textarea&gt;&lt;br&gt;</span><br><span class="line">    &lt;input type=&apos;submit&apos;&gt;</span><br><span class="line">    &lt;/form&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<p>例子解释：<br>1.首先，检查是否填写了邮件输入框<br>2.如果未填写（比如在页面被首次访问时），输出 HTML 表单<br>3.如果已填写（在表单被填写后），从表单发送邮件<br>4.当点击提交按钮后，重新载入页面，显示邮件发送成功的消息</p>
<p>注释：这个简易发送 e-mail 不安全，下面将为您讲解如何验证用户输入使它更安全。</p>
<p><strong>PHP E-mail 注入</strong><br>首先，请看上一节中的 PHP 代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">if (isset($_REQUEST[&apos;email&apos;])) &#123; // 如果接收到邮箱参数则发送邮件</span><br><span class="line">    // 发送邮件</span><br><span class="line">    $email = $_REQUEST[&apos;email&apos;] ;</span><br><span class="line">    $subject = $_REQUEST[&apos;subject&apos;] ;</span><br><span class="line">    $message = $_REQUEST[&apos;message&apos;] ;</span><br><span class="line">    mail(&quot;someone@example.com&quot;, $subject,</span><br><span class="line">    $message, &quot;From:&quot; . $email);</span><br><span class="line">    echo &quot;邮件发送成功&quot;;</span><br><span class="line">&#125; else &#123; // 如果没有邮箱参数则显示表单</span><br><span class="line">    echo &quot;&lt;form method=&apos;post&apos; action=&apos;mailform.php&apos;&gt;</span><br><span class="line">    Email: &lt;input name=&apos;email&apos; type=&apos;text&apos;&gt;&lt;br&gt;</span><br><span class="line">    Subject: &lt;input name=&apos;subject&apos; type=&apos;text&apos;&gt;&lt;br&gt;</span><br><span class="line">    Message:&lt;br&gt;</span><br><span class="line">    &lt;textarea name=&apos;message&apos; rows=&apos;15&apos; cols=&apos;40&apos;&gt;</span><br><span class="line">    &lt;/textarea&gt;&lt;br&gt;</span><br><span class="line">    &lt;input type=&apos;submit&apos;&gt;</span><br><span class="line">    &lt;/form&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<p>以上代码存在的问题是，未经授权的用户可通过输入表单在邮件头部插入数据。</p>
<p>假如用户在表单中的输入框内加入这些文本，会出现什么情况呢？<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">someone@example.com%0ACc:person2@example.com</span><br><span class="line">%0ABcc:person3@example.com,person3@example.com,</span><br><span class="line">anotherperson4@example.com,person5@example.com</span><br><span class="line">%0ABTo:person6@example.com</span><br></pre></td></tr></table></figure></p>
<p>与往常一样，mail() 函数把上面的文本放入邮件头部，那么现在头部有了额外的 Cc:, Bcc: 以及 To: 字段。当用户点击提交按钮时，这封 e-mail 会被发送到上面所有的地址！</p>
<p><strong>PHP 防止 E-mail 注入</strong><br>防止 e-mail 注入的最好方法是对输入进行验证。</p>
<p>下面的代码与上一节类似，不过我们已经增加了检测表单中 email 字段的输入验证程序：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">function spamcheck($field)</span><br><span class="line">&#123;</span><br><span class="line">    // filter_var() 过滤 e-mail</span><br><span class="line">    // 使用 FILTER_SANITIZE_EMAIL</span><br><span class="line">    $field=filter_var($field, FILTER_SANITIZE_EMAIL);</span><br><span class="line"></span><br><span class="line">    //filter_var() 过滤 e-mail</span><br><span class="line">    // 使用 FILTER_VALIDATE_EMAIL</span><br><span class="line">    if(filter_var($field, FILTER_VALIDATE_EMAIL))</span><br><span class="line">    &#123;</span><br><span class="line">        return TRUE;</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;</span><br><span class="line">        return FALSE;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if (isset($_REQUEST[&apos;email&apos;]))</span><br><span class="line">&#123;</span><br><span class="line">    // 如果接收到邮箱参数则发送邮件</span><br><span class="line"></span><br><span class="line">    // 判断邮箱是否合法</span><br><span class="line">    $mailcheck = spamcheck($_REQUEST[&apos;email&apos;]);</span><br><span class="line">    if ($mailcheck==FALSE)</span><br><span class="line">    &#123;</span><br><span class="line">        echo &quot;非法输入&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;    </span><br><span class="line">        // 发送邮件</span><br><span class="line">        $email = $_REQUEST[&apos;email&apos;] ;</span><br><span class="line">        $subject = $_REQUEST[&apos;subject&apos;] ;</span><br><span class="line">        $message = $_REQUEST[&apos;message&apos;] ;</span><br><span class="line">        mail(&quot;someone@example.com&quot;, &quot;Subject: $subject&quot;,</span><br><span class="line">        $message, &quot;From: $email&quot; );</span><br><span class="line">        echo &quot;Thank you for using our mail form&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123; </span><br><span class="line">    // 如果没有邮箱参数则显示表单</span><br><span class="line">    echo &quot;&lt;form method=&apos;post&apos; action=&apos;mailform.php&apos;&gt;</span><br><span class="line">    Email: &lt;input name=&apos;email&apos; type=&apos;text&apos;&gt;&lt;br&gt;</span><br><span class="line">    Subject: &lt;input name=&apos;subject&apos; type=&apos;text&apos;&gt;&lt;br&gt;</span><br><span class="line">    Message:&lt;br&gt;</span><br><span class="line">    &lt;textarea name=&apos;message&apos; rows=&apos;15&apos; cols=&apos;40&apos;&gt;</span><br><span class="line">    &lt;/textarea&gt;&lt;br&gt;</span><br><span class="line">    &lt;input type=&apos;submit&apos;&gt;</span><br><span class="line">    &lt;/form&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<p>在上面的代码中，我们使用了 PHP 过滤器来对输入进行验证：</p>
<ul>
<li>FILTER_SANITIZE_EMAIL 从字符串中删除电子邮件的非法字符</li>
<li>FILTER_VALIDATE_EMAIL 验证电子邮件地址</li>
</ul>
<h2 id="PHP-错误处理"><a href="#PHP-错误处理" class="headerlink" title="PHP 错误处理"></a>PHP 错误处理</h2><blockquote>
<p>在 PHP 中，默认的错误处理很简单。一条消息会被发送到浏览器，这条消息带有文件名、行号以及一条描述错误的消息。</p>
</blockquote>
<p><strong>PHP 错误处理</strong><br>在创建脚本和 web 应用程序时，错误处理是一个重要的部分。如果您的代码缺少错误检测编码，那么程序看上去很不专业，也为安全风险敞开了大门。<br>本教程介绍了 PHP 中一些最为重要的错误检测方法。<br>我们将为您讲解不同的错误处理方法：</p>
<ul>
<li>简单的 “die()” 语句</li>
<li>自定义错误和错误触发器</li>
<li>错误报告</li>
</ul>
<p><strong>基本的错误处理：使用 die() 函数</strong><br>第一个例子展示了一个打开文本文件的简单脚本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$file=fopen(&quot;welcome.txt&quot;,&quot;r&quot;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>如果文件不存在，您会获得类似这样的错误：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Warning: fopen(welcome.txt) [function.fopen]: failed to open stream: </span><br><span class="line">No such file or directory in C:\webfolder\test.php on line 2</span><br></pre></td></tr></table></figure></p>
<p>为了避免用户获得类似上面的错误消息，我们在访问文件之前检测该文件是否存在：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if(!file_exists(&quot;welcome.txt&quot;))</span><br><span class="line">&#123;</span><br><span class="line">    die(&quot;文件不存在&quot;);</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">    $file=fopen(&quot;welcome.txt&quot;,&quot;r&quot;);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>现在，假如文件不存在，您会得到类似这样的错误消息：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">文件不存在</span><br></pre></td></tr></table></figure></p>
<p>比起之前的代码，上面的代码更有效，这是由于它采用了一个简单的错误处理机制在错误之后终止了脚本。</p>
<p>不过，简单地终止脚本并不总是恰当的方式。让我们研究一下用于处理错误的备选的 PHP 函数。</p>
<p><strong>创建自定义错误处理器</strong><br>创建一个自定义的错误处理器非常简单。我们很简单地创建了一个专用函数，可以在 PHP 中发生错误时调用该函数。</p>
<p>该函数必须有能力处理至少两个参数 (error level 和 error message)，但是可以接受最多五个参数（可选的：file, line-number 以及 error context）：</p>
<p>语法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">error_function(error_level,error_message,</span><br><span class="line">error_file,error_line,error_context)</span><br></pre></td></tr></table></figure></p>
<table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">error_level</td>
<td>必需。为用户定义的错误规定错误报告级别。必须是一个值数。参见下面的表格：错误报告级别。</td>
</tr>
<tr>
<td style="text-align:left">error_message</td>
<td>必需。为用户定义的错误规定错误消息。</td>
</tr>
<tr>
<td style="text-align:left">error_file</td>
<td>可选。规定错误在其中发生的文件名。</td>
</tr>
<tr>
<td style="text-align:left">error_line</td>
<td>可选。规定错误发生的行号。</td>
</tr>
<tr>
<td style="text-align:left">error_context</td>
<td>可选。规定一个数组，包含了当错误发生时在用的每个变量以及它们的值。</td>
</tr>
</tbody>
</table>
<p><strong>错误报告级别</strong><br>这些错误报告级别是错误处理程序旨在处理的错误的不同的类型：</p>
<table>
<thead>
<tr>
<th style="text-align:left">值</th>
<th>常量</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">2</td>
<td>E_WARNING</td>
<td>非致命的 run-time 错误。不暂停脚本执行。</td>
</tr>
<tr>
<td style="text-align:left">8</td>
<td>E_NOTICE</td>
<td>Run-time 通知。脚本发现可能有错误发生，但也可能在脚本正常运行时发生。</td>
</tr>
<tr>
<td style="text-align:left">256</td>
<td>E_USER_ERROR</td>
<td>致命的用户生成的错误。这类似于程序员使用 PHP 函数 trigger_error() 设置的 E_ERROR。</td>
</tr>
<tr>
<td style="text-align:left">512</td>
<td>E_USER_WARNING</td>
<td>非致命的用户生成的警告。这类似于程序员使用 PHP 函数 trigger_error() 设置的 E_WARNING。</td>
</tr>
<tr>
<td style="text-align:left">1024</td>
<td>E_USER_NOTICE</td>
<td>用户生成的通知。这类似于程序员使用 PHP 函数 trigger_error() 设置的 E_NOTICE。</td>
</tr>
<tr>
<td style="text-align:left">4096</td>
<td>E_RECOVERABLE_ERROR</td>
<td>可捕获的致命错误。类似 E_ERROR，但可被用户定义的处理程序捕获。(参见 set_error_handler())</td>
</tr>
<tr>
<td style="text-align:left">8191</td>
<td>E_ALL</td>
<td>所有错误和警告，除级别 E_STRICT 以外。（在 PHP 6.0，E_STRICT 是 E_ALL 的一部分）</td>
</tr>
</tbody>
</table>
<p>现在，让我们创建一个处理错误的函数：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function customError($errno, $errstr)</span><br><span class="line">&#123;</span><br><span class="line">    echo &quot;&lt;b&gt;Error:&lt;/b&gt; [$errno] $errstr&lt;br&gt;&quot;;</span><br><span class="line">    echo &quot;脚本结束&quot;;</span><br><span class="line">    die();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>上面的代码是一个简单的错误处理函数。当它被触发时，它会取得错误级别和错误消息。然后它会输出错误级别和消息，并终止脚本。</p>
<p>现在，我们已经创建了一个错误处理函数，我们需要确定在何时触发该函数。</p>
<p><strong>Set Error Handler</strong><br>PHP 的默认错误处理程序是内建的错误处理程序。我们打算把上面的函数改造为脚本运行期间的默认错误处理程序。<br>可以修改错误处理程序，使其仅应用到某些错误，这样脚本就可以不同的方式来处理不同的错误。不过，在本例中，我们打算针对所有错误来使用我们的自定义错误处理程序：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set_error_handler(&quot;customError&quot;);</span><br></pre></td></tr></table></figure></p>
<p>由于我们希望我们的自定义函数来处理所有错误，set_error_handler() 仅需要一个参数，可以添加第二个参数来规定错误级别。<br>实例<br>通过尝试输出不存在的变量，来测试这个错误处理程序：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">// 错误处理函数</span><br><span class="line">function customError($errno, $errstr)</span><br><span class="line">&#123;</span><br><span class="line">    echo &quot;&lt;b&gt;Error:&lt;/b&gt; [$errno] $errstr&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 设置错误处理函数</span><br><span class="line">set_error_handler(&quot;customError&quot;);</span><br><span class="line"></span><br><span class="line">// 触发错误</span><br><span class="line">echo($test);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>以上代码的输出应该类似这样：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Error: [8] Undefined variable: test</span><br></pre></td></tr></table></figure></p>
<p><strong>触发错误</strong><br>在脚本中用户输入数据的位置，当用户的输入无效时触发错误的很有用的。在 PHP 中，这个任务由 trigger_error() 完成。</p>
<p>例子<br>在本例中，如果 “test” 变量大于 “1”，就会发生错误：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$test=2;</span><br><span class="line">if ($test&gt;1)</span><br><span class="line">&#123;</span><br><span class="line">    trigger_error(&quot;变量值必须小于等于 1&quot;);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>以上代码的输出应该类似这样：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Notice: 变量值必须小于等于 1</span><br><span class="line">in C:\webfolder\test.php on line 6</span><br></pre></td></tr></table></figure></p>
<p>您可以在脚本中任何位置触发错误，通过添加的第二个参数，您能够规定所触发的错误级别。</p>
<p><strong>可能的错误类型：</strong></p>
<ul>
<li>E_USER_ERROR - 致命的用户生成的 run-time 错误。错误无法恢复。脚本执行被中断。</li>
<li>E_USER_WARNING - 非致命的用户生成的 run-time 警告。脚本执行不被中断。</li>
<li>E_USER_NOTICE - 默认。用户生成的 run-time 通知。脚本发现了可能的错误，也有可能在脚本运行正常时发生。</li>
</ul>
<p>例子<br>在本例中，如果 “test” 变量大于 “1”，则发生 E_USER_WARNING 错误。如果发生了 E_USER_WARNING，我们将使用我们的自定义错误处理程序并结束脚本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">// 错误处理函数</span><br><span class="line">function customError($errno, $errstr)</span><br><span class="line">&#123;</span><br><span class="line">    echo &quot;&lt;b&gt;Error:&lt;/b&gt; [$errno] $errstr&lt;br&gt;&quot;;</span><br><span class="line">    echo &quot;脚本结束&quot;;</span><br><span class="line">    die();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 设置错误处理函数</span><br><span class="line">set_error_handler(&quot;customError&quot;,E_USER_WARNING);</span><br><span class="line"></span><br><span class="line">// 触发错误</span><br><span class="line">$test=2;</span><br><span class="line">if ($test&gt;1)</span><br><span class="line">&#123;</span><br><span class="line">    trigger_error(&quot;变量值必须小于等于 1&quot;,E_USER_WARNING);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>以上代码的输出应该类似这样：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Error: [512] 变量值必须小于等于 1</span><br><span class="line">脚本结束</span><br></pre></td></tr></table></figure></p>
<p>现在，我们已经学习了如何创建自己的 error，以及如何触发它们，现在我们研究一下错误记录。</p>
<p><strong>错误记录</strong><br>默认地，根据在 php.ini 中的 error_log 配置，PHP 向服务器的错误记录系统或文件发送错误记录。通过使用 error_log() 函数，您可以向指定的文件或远程目的地发送错误记录。<br>通过电子邮件向您自己发送错误消息，是一种获得指定错误的通知的好办法。</p>
<p><strong>通过 E-Mail 发送错误消息</strong><br>在下面的例子中，如果特定的错误发生，我们将发送带有错误消息的电子邮件，并结束脚本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">// 错误处理函数</span><br><span class="line">function customError($errno, $errstr)</span><br><span class="line">&#123;</span><br><span class="line">    echo &quot;&lt;b&gt;Error:&lt;/b&gt; [$errno] $errstr&lt;br&gt;&quot;;</span><br><span class="line">    echo &quot;已通知网站管理员&quot;;</span><br><span class="line">    error_log(&quot;Error: [$errno] $errstr&quot;,1,</span><br><span class="line">    &quot;someone@example.com&quot;,&quot;From: webmaster@example.com&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 设置错误处理函数</span><br><span class="line">set_error_handler(&quot;customError&quot;,E_USER_WARNING);</span><br><span class="line"></span><br><span class="line">// 触发错误</span><br><span class="line">$test=2;</span><br><span class="line">if ($test&gt;1)</span><br><span class="line">&#123;</span><br><span class="line">    trigger_error(&quot;变量值必须小于等于 1&quot;,E_USER_WARNING);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>以上代码的输出应该类似这样：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Error: [512] 变量值必须小于等于 1</span><br><span class="line">已通知网站管理员</span><br></pre></td></tr></table></figure></p>
<p>接收自以上代码的邮件类似这样：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Error: [512] 变量值必须小于等于 1</span><br></pre></td></tr></table></figure></p>
<p>这个方法不适合所有的错误。常规错误应当通过使用默认的 PHP 记录系统在服务器上进行记录。</p>
<h2 id="PHP-异常处理"><a href="#PHP-异常处理" class="headerlink" title="PHP 异常处理"></a>PHP 异常处理</h2><p><strong>异常（Exception）用于在指定的错误发生时改变脚本的正常流程。</strong></p>
<p><strong>什么是异常？</strong><br>PHP 5 提供了一种新的面向对象的错误处理方法。<br>异常处理用于在指定的错误（异常）情况发生时改变脚本的正常流程。这种情况称为异常。<br>当异常被触发时，通常会发生：</p>
<ul>
<li>当前代码状态被保存</li>
<li>代码执行被切换到预定义的异常处理器函数</li>
<li>根据情况，处理器也许会从保存的代码状态重新开始执行代码，终止脚本执行，或从代码中另外的位置继续执行脚本</li>
</ul>
<p>我们将展示不同的错误处理方法：</p>
<ul>
<li>异常的基本使用</li>
<li>创建自定义的异常处理器</li>
<li>多个异常</li>
<li>重新抛出异常</li>
<li>设置顶层异常处理器</li>
</ul>
<p><strong>注释：</strong>异常应该仅仅在错误情况下使用，而不应该用于在一个指定的点跳转到代码的另一个位置。</p>
<p><strong>异常的基本使用</strong><br>当异常被抛出时，其后的代码不会继续执行，PHP 会尝试查找匹配的 “catch” 代码块。<br>如果异常没有被捕获，而且又没用使用 set_exception_handler() 作相应的处理的话，那么将发生一个严重的错误（致命错误），并且输出 “Uncaught Exception” （未捕获异常）的错误消息。<br>让我们尝试抛出一个异常，同时不去捕获它：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//create function with an exception</span><br><span class="line">function checkNum($number)</span><br><span class="line"> &#123;</span><br><span class="line"> if($number&gt;1)</span><br><span class="line">  &#123;</span><br><span class="line">  throw new Exception(&quot;Value must be 1 or below&quot;);</span><br><span class="line">  &#125;</span><br><span class="line"> return true;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line">//trigger exception</span><br><span class="line">checkNum(2);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>上面的代码会获得类似这样的一个错误：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Fatal error: Uncaught exception &apos;Exception&apos; </span><br><span class="line">with message &apos;Value must be 1 or below&apos; in C:\webfolder\test.php:6 </span><br><span class="line">Stack trace: #0 C:\webfolder\test.php(12): </span><br><span class="line">checkNum(28) #1 &#123;main&#125; thrown in C:\webfolder\test.php on line 6</span><br></pre></td></tr></table></figure></p>
<p><strong>Try, throw 和 catch</strong><br>要避免上面例子出现的错误，我们需要创建适当的代码来处理异常。</p>
<p>正确的处理程序应当包括：<br>1.Try - 使用异常的函数应该位于 “try” 代码块内。如果没有触发异常，则代码将照常继续执行。但是如果异常被触发，会抛出一个异常。<br>2.Throw - 这里规定如何触发异常。每一个 “throw” 必须对应至少一个 “catch”<br>3.Catch - “catch” 代码块会捕获异常，并创建一个包含异常信息的对象<br>让我们触发一个异常：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//创建可抛出一个异常的函数</span><br><span class="line">function checkNum($number)</span><br><span class="line"> &#123;</span><br><span class="line"> if($number&gt;1)</span><br><span class="line">  &#123;</span><br><span class="line">  throw new Exception(&quot;Value must be 1 or below&quot;);</span><br><span class="line">  &#125;</span><br><span class="line"> return true;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line">//在 &quot;try&quot; 代码块中触发异常</span><br><span class="line">try</span><br><span class="line"> &#123;</span><br><span class="line"> checkNum(2);</span><br><span class="line"> //If the exception is thrown, this text will not be shown</span><br><span class="line"> echo &apos;If you see this, the number is 1 or below&apos;;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line">//捕获异常</span><br><span class="line">catch(Exception $e)</span><br><span class="line"> &#123;</span><br><span class="line"> echo &apos;Message: &apos; .$e-&gt;getMessage();</span><br><span class="line"> &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>上面代码将获得类似这样一个错误：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Message: Value must be 1 or below</span><br></pre></td></tr></table></figure></p>
<p>例子解释：<br>上面的代码抛出了一个异常，并捕获了它：</p>
<p>1.创建 checkNum() 函数。它检测数字是否大于 1。如果是，则抛出一个异常。<br>2.在 “try” 代码块中调用 checkNum() 函数。<br>3.checkNum() 函数中的异常被抛出<br>4.”catch” 代码块接收到该异常，并创建一个包含异常信息的对象 ($e)。<br>5.通过从这个 exception 对象调用 $e-&gt;getMessage()，输出来自该异常的错误消息<br>不过，为了遵循“每个 throw 必须对应一个 catch”的原则，可以设置一个顶层的异常处理器来处理漏掉的错误。</p>
<p><strong>创建一个自定义的 Exception 类</strong><br>创建自定义的异常处理程序非常简单。我们简单地创建了一个专门的类，当 PHP 中发生异常时，可调用其函数。该类必须是 exception 类的一个扩展。</p>
<p>这个自定义的 exception 类继承了 PHP 的 exception 类的所有属性，您可向其添加自定义的函数。</p>
<p>我们开始创建 exception 类：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class customException extends Exception</span><br><span class="line">&#123;</span><br><span class="line">    public function errorMessage()</span><br><span class="line">    &#123;</span><br><span class="line">        // 错误信息</span><br><span class="line">        $errorMsg = &apos;错误行号 &apos;.$this-&gt;getLine().&apos; in &apos;.$this-&gt;getFile()</span><br><span class="line">        .&apos;: &lt;b&gt;&apos;.$this-&gt;getMessage().&apos;&lt;/b&gt; 不是一个合法的 E-Mail 地址&apos;;</span><br><span class="line">        return $errorMsg;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">$email = &quot;someone@example...com&quot;;</span><br><span class="line"> </span><br><span class="line">try</span><br><span class="line">&#123;</span><br><span class="line">    // 检测邮箱</span><br><span class="line">    if(filter_var($email, FILTER_VALIDATE_EMAIL) === FALSE)</span><br><span class="line">    &#123;</span><br><span class="line">        // 如果是个不合法的邮箱地址，抛出异常</span><br><span class="line">        throw new customException($email);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">catch (customException $e)</span><br><span class="line">&#123;</span><br><span class="line">//display custom message</span><br><span class="line">echo $e-&gt;errorMessage();</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>这个新的类是旧的 exception 类的副本，外加 errorMessage() 函数。正因为它是旧类的副本，因此它从旧类继承了属性和方法，我们可以使用 exception 类的方法，比如 getLine() 、 getFile() 以及 getMessage()。</p>
<p>例子解释：<br>上面的代码抛出了一个异常，并通过一个自定义的 exception 类来捕获它：</p>
<p>1.customException() 类是作为旧的 exception 类的一个扩展来创建的。这样它就继承了旧类的所有属性和方法。<br>2.创建 errorMessage() 函数。如果 e-mail 地址不合法，则该函数返回一条错误消息<br>3.把 $email 变量设置为不合法的 e-mail 地址字符串<br>4.执行 “try” 代码块，由于 e-mail 地址不合法，因此抛出一个异常<br>5.”catch” 代码块捕获异常，并显示错误消息<br><strong>多个异常</strong><br>可以为一段脚本使用多个异常，来检测多种情况。<br>可以使用多个 if..else 代码块，或一个 switch 代码块，或者嵌套多个异常。这些异常能够使用不同的 exception 类，并返回不同的错误消息：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class customException extends Exception</span><br><span class="line">&#123;</span><br><span class="line">    public function errorMessage()</span><br><span class="line">    &#123;</span><br><span class="line">        // 错误信息</span><br><span class="line">        $errorMsg = &apos;错误行号 &apos;.$this-&gt;getLine().&apos; in &apos;.$this-&gt;getFile()</span><br><span class="line">        .&apos;: &lt;b&gt;&apos;.$this-&gt;getMessage().&apos;&lt;/b&gt; 不是一个合法的 E-Mail 地址&apos;;</span><br><span class="line">        return $errorMsg;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">$email = &quot;someone@example.com&quot;;</span><br><span class="line"> </span><br><span class="line">try</span><br><span class="line">&#123;</span><br><span class="line">    // 检测邮箱</span><br><span class="line">    if(filter_var($email, FILTER_VALIDATE_EMAIL) === FALSE)</span><br><span class="line">    &#123;</span><br><span class="line">        // 如果是个不合法的邮箱地址，抛出异常</span><br><span class="line">        throw new customException($email);</span><br><span class="line">    &#125;</span><br><span class="line">    // 检测 &quot;example&quot; 是否在邮箱地址中</span><br><span class="line">    if(strpos($email, &quot;example&quot;) !== FALSE)</span><br><span class="line">    &#123;</span><br><span class="line">        throw new Exception(&quot;$email 是 example 邮箱&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">catch (customException $e)</span><br><span class="line">&#123;</span><br><span class="line">    echo $e-&gt;errorMessage();</span><br><span class="line">&#125;</span><br><span class="line">catch(Exception $e)</span><br><span class="line">&#123;</span><br><span class="line">    echo $e-&gt;getMessage();</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>例子解释：<br>上面的代码测试了两种条件，如何任何条件不成立，则抛出一个异常：</p>
<p>1.customException() 类是作为旧的 exception 类的一个扩展来创建的。这样它就继承了旧类的所有属性和方法。<br>2.创建 errorMessage() 函数。如果 e-mail 地址不合法，则该函数返回一个错误消息。<br>3.执行 “try” 代码块，在第一个条件下，不会抛出异常。<br>4..由于 e-mail 含有字符串 “example”，第二个条件会触发异常。<br>5.”catch” 代码块会捕获异常，并显示恰当的错误消息<br>如果没有捕获 customException，紧紧捕获了 base exception，则在那里处理异常。</p>
<p><strong>重新抛出异常</strong><br>有时，当异常被抛出时，您也许希望以不同于标准的方式对它进行处理。可以在一个 “catch” 代码块中再次抛出异常。</p>
<p>脚本应该对用户隐藏系统错误。对程序员来说，系统错误也许很重要，但是用户对它们并不感兴趣。为了让用户更容易使用，您可以再次抛出带有对用户比较友好的消息的异常：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class customException extends Exception</span><br><span class="line">&#123;</span><br><span class="line">    public function errorMessage()</span><br><span class="line">    &#123;</span><br><span class="line">        // 错误信息</span><br><span class="line">        $errorMsg = $this-&gt;getMessage().&apos; 不是一个合法的 E-Mail 地址。&apos;;</span><br><span class="line">        return $errorMsg;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">$email = &quot;someone@example.com&quot;;</span><br><span class="line"> </span><br><span class="line">try</span><br><span class="line">&#123;</span><br><span class="line">    try</span><br><span class="line">    &#123;</span><br><span class="line">        // 检测 &quot;example&quot; 是否在邮箱地址中</span><br><span class="line">        if(strpos($email, &quot;example&quot;) !== FALSE)</span><br><span class="line">        &#123;</span><br><span class="line">            // 如果是个不合法的邮箱地址，抛出异常</span><br><span class="line">            throw new Exception($email);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    catch(Exception $e)</span><br><span class="line">    &#123;</span><br><span class="line">        // 重新抛出异常</span><br><span class="line">        throw new customException($email);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">catch (customException $e)</span><br><span class="line">&#123;</span><br><span class="line">    // 显示自定义信息</span><br><span class="line">    echo $e-&gt;errorMessage();</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>例子解释：<br>上面的代码检测在邮件地址中是否含有字符串 “example”。如果有，则再次抛出异常：</p>
<p>1.customException() 类是作为旧的 exception 类的一个扩展来创建的。这样它就继承了旧类的所有属性和方法。<br>2.创建 errorMessage() 函数。如果 e-mail 地址不合法，则该函数返回一个错误消息。<br>3.把 $email 变量设置为一个有效的邮件地址，但含有字符串 “example”。<br>4.”try” 代码块包含另一个 “try” 代码块，这样就可以再次抛出异常。<br>5.由于 e-mail 包含字符串 “example”，因此触发异常。<br>6.”catch” 捕获到该异常，并重新抛出 “customException”。<br>7.捕获到 “customException”，并显示一条错误消息。<br>如果在其目前的 “try” 代码块中异常没有被捕获，则它将在更高层级上查找 catch 代码块。</p>
<p><strong>设置顶层异常处理器 （Top Level Exception Handler）</strong><br>set_exception_handler() 函数可设置处理所有未捕获异常的用户定义函数。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">function myException($exception)</span><br><span class="line">&#123;</span><br><span class="line">echo &quot;&lt;b&gt;Exception:&lt;/b&gt; &quot; , $exception-&gt;getMessage();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">set_exception_handler(&apos;myException&apos;);</span><br><span class="line"></span><br><span class="line">throw new Exception(&apos;Uncaught Exception occurred&apos;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>以上代码的输出应该类似这样：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Exception: Uncaught Exception occurred</span><br></pre></td></tr></table></figure></p>
<p>在上面的代码中，不存在 “catch” 代码块，而是触发顶层的异常处理程序。应该使用此函数来捕获所有未被捕获的异常。</p>
<p><strong>异常的规则</strong></p>
<ul>
<li>需要进行异常处理的代码应该放入 try 代码块内，以便捕获潜在的异常。</li>
<li>每个 try 或 throw 代码块必须至少拥有一个对应的 catch 代码块。</li>
<li>使用多个 catch 代码块可以捕获不同种类的异常。</li>
<li>可以在 try 代码块内的 catch 代码块中再次抛出（re-thrown）异常。<br><strong>简而言之：如果抛出了异常，就必须捕获它。</strong></li>
</ul>
<h2 id="PHP-过滤器（Filter）"><a href="#PHP-过滤器（Filter）" class="headerlink" title="PHP 过滤器（Filter）"></a>PHP 过滤器（Filter）</h2><p><strong>PHP 过滤器用于验证和过滤来自非安全来源的数据，比如用户的输入。</strong></p>
<p><strong>什么是 PHP 过滤器？</strong><br>PHP 过滤器用于验证和过滤来自非安全来源的数据。<br>验证和过滤用户输入或自定义数据是任何 Web 应用程序的重要组成部分。<br>设计 PHP 的过滤器扩展的目的是使数据过滤更轻松快捷。</p>
<p><strong>为什么使用过滤器？</strong><br>几乎所有 web 应用程序都依赖外部的输入。这些数据通常来自用户或其他应用程序（比如 web 服务）。通过使用过滤器，您能够确保应有程序获得正确的输入类型。<br>您应该始终对外部数据进行过滤！<br>输入过滤是最重要的应用程序安全课题之一。</p>
<p><strong>什么是外部数据？</strong></p>
<ul>
<li>来自表单的输入数据</li>
<li>Cookies</li>
<li>Web services data</li>
<li>服务器变量</li>
<li>数据库查询结果</li>
</ul>
<p><strong>函数和过滤器</strong><br>如需过滤变量，请使用下面的过滤器函数之一：</p>
<ul>
<li>filter_var() - 通过一个指定的过滤器来过滤单一的变量</li>
<li>filter_var_array() - 通过相同的或不同的过滤器来过滤多个变量</li>
<li>filter_input - 获取一个输入变量，并对它进行过滤</li>
<li>filter_input_array - 获取多个输入变量，并通过相同的或不同的过滤器对它们进行过滤</li>
</ul>
<p>在下面的例子中，我们用 filter_var() 函数验证了一个整数：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$int = 123;</span><br><span class="line"> </span><br><span class="line">if(!filter_var($int, FILTER_VALIDATE_INT))</span><br><span class="line">&#123;</span><br><span class="line">    echo(&quot;不是一个合法的整数&quot;);</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">    echo(&quot;是个合法的整数&quot;);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>上面的代码使用了 “FILTER_VALIDATE_INT” 过滤器来过滤变量。由于这个整数是合法的，因此代码的输出是：”Integer is valid”。<br><img src="/2019/02/02/PHP技能升阶/0C55.jpg" alt=""><br>假如我们尝试使用一个非整数的变量（比如 “123abc”），则输出是：”Integer is not valid”。</p>
<p><strong>Validating 和 Sanitizing</strong><br>有两种过滤器：</p>
<ul>
<li>Validating 过滤器：<ul>
<li>用于验证用户输入</li>
<li>严格的格式规则（比如 URL 或 E-Mail 验证）</li>
<li>如果成功则返回预期的类型，如果失败则返回 FALSE</li>
</ul>
</li>
<li>Sanitizing 过滤器：<ul>
<li>用于允许或禁止字符串中指定的字符</li>
<li>无数据格式规则</li>
<li>始终返回字符串</li>
</ul>
</li>
</ul>
<p><strong>选项和标志</strong><br>选项和标志用于向指定的过滤器添加额外的过滤选项。<br>不同的过滤器有不同的选项和标志。<br>在下面的例子中，我们用 filter_var() 和 “min_range” 以及 “max_range” 选项验证了一个整数：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$var=300;</span><br><span class="line"></span><br><span class="line">$int_options = array(</span><br><span class="line">&quot;options&quot;=&gt;array</span><br><span class="line"> (</span><br><span class="line"> &quot;min_range&quot;=&gt;0,</span><br><span class="line"> &quot;max_range&quot;=&gt;256</span><br><span class="line"> )</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">if(!filter_var($var, FILTER_VALIDATE_INT, $int_options))</span><br><span class="line"> &#123;</span><br><span class="line"> echo(&quot;Integer is not valid&quot;);</span><br><span class="line"> &#125;</span><br><span class="line">else</span><br><span class="line"> &#123;</span><br><span class="line"> echo(&quot;Integer is valid&quot;);</span><br><span class="line"> &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>就像上面的代码一样，选项必须放入一个名为 “options” 的相关数组中。如果使用标志，则不需在数组内。<br>由于整数是 “300”，它不在指定的范围内，以上代码的输出将是 “Integer is not valid”。<br>如需完整的函数及过滤器列表，您可以看到每个过滤器的可用选项和标志。</p>
<p><strong>验证输入</strong><br>让我们试着验证来自表单的输入。<br>我们需要作的第一件事情是确认是否存在我们正在查找的输入数据。<br>然后我们用 filter_input() 函数过滤输入的数据。<br>在下面的例子中，输入变量 “email” 被传到 PHP 页面：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if(!filter_has_var(INPUT_GET, &quot;email&quot;))</span><br><span class="line">&#123;</span><br><span class="line">    echo(&quot;没有 email 参数&quot;);</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">    if (!filter_input(INPUT_GET, &quot;email&quot;, FILTER_VALIDATE_EMAIL))</span><br><span class="line">    &#123;</span><br><span class="line">        echo &quot;不是一个合法的 E-Mail&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;</span><br><span class="line">        echo &quot;是一个合法的 E-Mail&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>以上实例测试结果如下：<br><img src="/2019/02/02/PHP技能升阶/08E00.jpg" alt=""><br>例子解释：<br>上面的例子有一个通过 “GET” 方法传送的输入变量 (email)：<br>1.检测是否存在 “GET” 类型的 “email” 输入变量<br>2.如果存在输入变量，检测它是否是有效的邮件地址</p>
<p><strong>净化输入</strong><br>让我们试着清理一下从表单传来的 URL。</p>
<p>首先，我们要确认是否存在我们正在查找的输入数据。</p>
<p>然后，我们用 filter_input() 函数来净化输入数据。</p>
<p>在下面的例子中，输入变量 “url” 被传到 PHP 页面：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if(!filter_has_var(INPUT_GET, &quot;url&quot;))</span><br><span class="line">&#123;</span><br><span class="line">    echo(&quot;没有 url 参数&quot;);</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">    $url = filter_input(INPUT_GET, </span><br><span class="line">    &quot;url&quot;, FILTER_SANITIZE_URL);</span><br><span class="line">    echo $url;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>例子解释：<br>上面的例子有一个通过 “POST” 方法传送的输入变量 (url)：</p>
<p>1.检测是否存在 “POST” 类型的 “url” 输入变量<br>2.如果存在此输入变量，对其进行净化（删除非法字符），并将其存储在 $url 变量中<br>假如输入变量类似这样：”<a href="http://www.W3非o法ol.com.c字符n/&quot;，则净化后的" target="_blank" rel="noopener">http://www.W3非o法ol.com.c字符n/&quot;，则净化后的</a> $url 变量应该是这样的：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.W3School.com.cn/</span><br></pre></td></tr></table></figure></p>
<p><strong>过滤多个输入</strong><br>表单通常由多个输入字段组成。为了避免对 filter_var 或 filter_input 重复调用，我们可以使用 filter_var_array 或 the filter_input_array 函数。</p>
<p>在本例中，我们使用 filter_input_array() 函数来过滤三个 GET 变量。接收到的 GET 变量是一个名字、一个年龄以及一个邮件地址：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$filters = array</span><br><span class="line"> (</span><br><span class="line"> &quot;name&quot; =&gt; array</span><br><span class="line">  (</span><br><span class="line">  &quot;filter&quot;=&gt;FILTER_SANITIZE_STRING</span><br><span class="line">  ),</span><br><span class="line"> &quot;age&quot; =&gt; array</span><br><span class="line">  (</span><br><span class="line">  &quot;filter&quot;=&gt;FILTER_VALIDATE_INT,</span><br><span class="line">  &quot;options&quot;=&gt;array</span><br><span class="line">   (</span><br><span class="line">   &quot;min_range&quot;=&gt;1,</span><br><span class="line">   &quot;max_range&quot;=&gt;120</span><br><span class="line">   )</span><br><span class="line">  ),</span><br><span class="line"> &quot;email&quot;=&gt; FILTER_VALIDATE_EMAIL,</span><br><span class="line"> );</span><br><span class="line"></span><br><span class="line">$result = filter_input_array(INPUT_GET, $filters);</span><br><span class="line"></span><br><span class="line">if (!$result[&quot;age&quot;])</span><br><span class="line"> &#123;</span><br><span class="line"> echo(&quot;Age must be a number between 1 and 120.&lt;br /&gt;&quot;);</span><br><span class="line"> &#125;</span><br><span class="line">elseif(!$result[&quot;email&quot;])</span><br><span class="line"> &#123;</span><br><span class="line"> echo(&quot;E-Mail is not valid.&lt;br /&gt;&quot;);</span><br><span class="line"> &#125;</span><br><span class="line">else</span><br><span class="line"> &#123;</span><br><span class="line"> echo(&quot;User input is valid&quot;);</span><br><span class="line"> &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>例子解释：<br>上面的例子有三个通过 “GET” 方法传送的输入变量 (name, age and email)<br>1.设置一个数组，其中包含了输入变量的名称，以及用于指定的输入变量的过滤器<br>2.调用 filter_input_array 函数，参数包括 GET 输入变量及刚才设置的数组<br>3.检测 $result 变量中的 “age” 和 “email” 变量是否有非法的输入。（如果存在非法输入，）<br>filter_input_array() 函数的第二个参数可以是数组或单一过滤器的 ID。</p>
<p>如果该参数是单一过滤器的 ID，那么这个指定的过滤器会过滤输入数组中所有的值。</p>
<p>如果该参数是一个数组，那么此数组必须遵循下面的规则：</p>
<ul>
<li>必须是一个关联数组，其中包含的输入变量是数组的键（比如 “age” 输入变量）</li>
<li>此数组的值必须是过滤器的 ID ，或者是规定了过滤器、标志以及选项的数组</li>
</ul>
<p><strong>使用 Filter Callback</strong><br>通过使用 FILTER_CALLBACK 过滤器，可以调用自定义的函数，把它作为一个过滤器来使用。这样，我们就拥有了数据过滤的完全控制权。</p>
<p>您可以创建自己的自定义函数，也可以使用已有的 PHP 函数。</p>
<p>规定您准备用到过滤器函数的方法，与规定选项的方法相同。</p>
<p>在下面的例子中，我们使用了一个自定义的函数把所有 “_” 转换为空格：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">function convertSpace($string)</span><br><span class="line">&#123;</span><br><span class="line">return str_replace(&quot;_&quot;, &quot; &quot;, $string);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$string = &quot;Peter_is_a_great_guy!&quot;;</span><br><span class="line"></span><br><span class="line">echo filter_var($string, FILTER_CALLBACK, array(&quot;options&quot;=&gt;&quot;convertSpace&quot;));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>以上代码的结果是这样的：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Peter is a great guy!</span><br></pre></td></tr></table></figure></p>
<p>例子解释：<br>上面的例子把所有 “<em>“ 转换成空格：<br>1.创建一个把 “</em>“ 替换为空格的函数<br>2.调用 filter_var() 函数，它的参数是 FILTER_CALLBACK 过滤器以及包含我们的函数的数组</p>

        </div>
        <footer class="article-footer">
            



    <a data-url="http://yoursite.com/2019/02/02/PHP技能升阶/" data-id="cjrncl7kz0057nkfvrjb7q3fz" class="article-share-link"><i class="fa fa-share"></i>分享到</a>
<script>
    (function ($) {
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

        </footer>
    </div>
</article>

    <section id="comments">
    
        
    <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>

    
    </section>



                        </div>
                    </section>
                    <aside id="sidebar">
    <a class="sidebar-toggle" title="Expand Sidebar"><i class="toggle icon"></i></a>
    <div class="sidebar-top">
        <p>关注我 :</p>
        <ul class="social-links">
            
                
                <li>
                    <a class="social-tooltip" title="twitter" href="/" target="_blank" rel="noopener">
                        <i class="icon fa fa-twitter"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="facebook" href="/" target="_blank" rel="noopener">
                        <i class="icon fa fa-facebook"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="google-plus" href="/" target="_blank" rel="noopener">
                        <i class="icon fa fa-google-plus"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="github" href="https://github.com/ppoffice/hexo-theme-hueman" target="_blank" rel="noopener">
                        <i class="icon fa fa-github"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="weibo" href="/" target="_blank" rel="noopener">
                        <i class="icon fa fa-weibo"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="rss" href="/" target="_blank" rel="noopener">
                        <i class="icon fa fa-rss"></i>
                    </a>
                </li>
                
            
        </ul>
    </div>
    
        
<nav id="article-nav">
    
    
        <a href="/2019/02/01/bootstrap-table表格导出/" id="article-nav-older" class="article-nav-link-wrap">
        <strong class="article-nav-caption">上一篇</strong>
        <p class="article-nav-title">bootstrap-table表格导出</p>
        <i class="icon fa fa-chevron-left" id="icon-chevron-left"></i>
        </a>
    
</nav>

    
    <div class="widgets-container">
        
            
                

            
                
    <div class="widget-wrap">
        <h3 class="widget-title">最新文章</h3>
        <div class="widget">
            <ul id="recent-post" class="">
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2019/02/02/PHP技能升阶/" class="thumbnail">
    
    
        <span style="background-image:url(/2019/02/02/PHP技能升阶/7fi6oy5ysf.jpeg)" alt="PHP技能升阶" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2019/02/02/PHP技能升阶/" class="title">PHP技能升阶</a></p>
                            <p class="item-date"><time datetime="2019-02-02T01:24:14.000Z" itemprop="datePublished">2019-02-02</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2019/02/01/bootstrap-table表格导出/" class="thumbnail">
    
    
        <span style="background-image:url(/2019/02/01/bootstrap-table表格导出/gp=0.jpg)" alt="bootstrap-table表格导出" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2019/02/01/bootstrap-table表格导出/" class="title">bootstrap-table表格导出</a></p>
                            <p class="item-date"><time datetime="2019-02-01T06:53:22.000Z" itemprop="datePublished">2019-02-01</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2019/02/01/vue里面关于created和mounted的区别/" class="thumbnail">
    
    
        <span style="background-image:url(/2019/02/01/vue里面关于created和mounted的区别/32402.jpg)" alt="vue里面关于created和mounted的区别" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2019/02/01/vue里面关于created和mounted的区别/" class="title">vue里面关于created和mounted的区别</a></p>
                            <p class="item-date"><time datetime="2019-02-01T06:42:11.000Z" itemprop="datePublished">2019-02-01</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2019/01/31/怎么“假装”架构师/" class="thumbnail">
    
    
        <span style="background-image:url(/2019/01/31/怎么“假装”架构师/2056.jpg)" alt="怎么“假装”架构师" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2019/01/31/怎么“假装”架构师/" class="title">怎么“假装”架构师</a></p>
                            <p class="item-date"><time datetime="2019-01-31T12:09:09.000Z" itemprop="datePublished">2019-01-31</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2019/01/31/用Python再次理解选择排序/" class="thumbnail">
    
    
        <span style="background-image:url(/2019/01/31/用Python再次理解选择排序/43eb.jpg)" alt="用Python再次理解选择排序" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2019/01/31/用Python再次理解选择排序/" class="title">用Python再次理解选择排序</a></p>
                            <p class="item-date"><time datetime="2019-01-31T09:43:25.000Z" itemprop="datePublished">2019-01-31</time></p>
                        </div>
                    </li>
                
            </ul>
        </div>
    </div>

            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">分类</h3>
        <div class="widget">
            <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/遥感/">遥感</a><span class="category-list-count">1</span></li></ul>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">归档</h3>
        <div class="widget">
            <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">二月 2019</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">一月 2019</a><span class="archive-list-count">30</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">十二月 2018</a><span class="archive-list-count">27</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">十一月 2018</a><span class="archive-list-count">15</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">十月 2018</a><span class="archive-list-count">9</span></li></ul>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">标签</h3>
        <div class="widget">
            <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/">JavaScript</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP/">PHP</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/html/">html</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript库/">javascript库</a><span class="tag-list-count">18</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/maven/">maven</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node/">node</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/orcal/">orcal</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/冷知识/">冷知识</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/心语/">心语</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/技术/">技术</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据结构与算法/">数据结构与算法</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/舆论/">舆论</a><span class="tag-list-count">1</span></li></ul>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-float">
        <h3 class="widget-title">标签云</h3>
        <div class="widget tagcloud">
            <a href="/tags/JavaScript/" style="font-size: 18.89px;">JavaScript</a> <a href="/tags/PHP/" style="font-size: 14.44px;">PHP</a> <a href="/tags/git/" style="font-size: 11.11px;">git</a> <a href="/tags/html/" style="font-size: 12.22px;">html</a> <a href="/tags/java/" style="font-size: 17.78px;">java</a> <a href="/tags/javascript库/" style="font-size: 20px;">javascript库</a> <a href="/tags/maven/" style="font-size: 16.67px;">maven</a> <a href="/tags/node/" style="font-size: 11.11px;">node</a> <a href="/tags/orcal/" style="font-size: 13.33px;">orcal</a> <a href="/tags/python/" style="font-size: 14.44px;">python</a> <a href="/tags/冷知识/" style="font-size: 11.11px;">冷知识</a> <a href="/tags/心语/" style="font-size: 10px;">心语</a> <a href="/tags/技术/" style="font-size: 11.11px;">技术</a> <a href="/tags/数据结构与算法/" style="font-size: 15.56px;">数据结构与算法</a> <a href="/tags/舆论/" style="font-size: 10px;">舆论</a>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">链接</h3>
        <div class="widget">
            <ul>
                
                    <li>
                        <a href="http://hexo.io">Hexo</a>
                    </li>
                
            </ul>
        </div>
    </div>


            
        
    </div>
</aside>

                </div>
            </div>
        </div>
        <footer id="footer">
    <div class="container">
        <div class="container-inner">
            <a id="back-to-top" href="javascript:;"><i class="icon fa fa-angle-up"></i></a>
            <div class="credit">
                <h1 class="logo-wrap">
                    <a href="/" class="logo"></a>
                </h1>
                <p>&copy; 2019 陈义</p>
                <p>Powered by <a href="//hexo.io/" target="_blank">Hexo</a>. Theme by <a href="//github.com/ppoffice" target="_blank">PPOffice</a></p>
            </div>
            <div>
                <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
                本站总访问量 <span id="busuanzi_value_site_pv"></span> 次&nbsp&nbsp&nbsp
                本站访客数<span id="busuanzi_value_site_uv"></span>人次
            </div>
            <div class="footer-plugins">
              
    


            </div>
        </div>
    </div>
</footer>

        
    
    <script>
    var disqus_shortname = 'hexo-theme-hueman';
    
    
    var disqus_url = 'http://yoursite.com/2019/02/02/PHP技能升阶/';
    
    (function() {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    </script>




    
        <script src="/libs/lightgallery/js/lightgallery.min.js"></script>
        <script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>
        <script src="/libs/lightgallery/js/lg-pager.min.js"></script>
        <script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>
        <script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>
        <script src="/libs/lightgallery/js/lg-zoom.min.js"></script>
        <script src="/libs/lightgallery/js/lg-hash.min.js"></script>
        <script src="/libs/lightgallery/js/lg-share.min.js"></script>
        <script src="/libs/lightgallery/js/lg-video.min.js"></script>
    
    
        <script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>
    
    



<!-- Custom Scripts -->
<script src="/js/main.js"></script>

    </div>
</body>
</html>
